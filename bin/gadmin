#!/usr/bin/env ruby
# vim: ft=ruby

libdir = File.expand_path(File.dirname(__FILE__)).sub('bin', 'lib')
Dir.exists?(libdir) && $LOAD_PATH.unshift(libdir)

require 'tty-reader'
require 'gadmin'

puts "*** gadmin ***"
puts "%% Press ctrl+x to exit."

reader  = TTY::Reader.new
workdir = File.expand_path(File.join(File.dirname(File.expand_path(__FILE__)), '..'))
$gadmin = Gadmin::Session.new(workdir).start!

reader.on(:keyctrl_x) { puts "Exiting.."; exit }

loop do
  line = reader.read_line('=> ')
  $gadmin.command line
  $gadmin.execute
end
